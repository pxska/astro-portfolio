---
import "@styles/globals.css";
import Metadata from "@components/Metadata.astro";
import { sortPosts } from "@utils/utils";
import { CornerUpLeft } from "lucide-astro";

const { frontmatter } = Astro.props;

const posts = sortPosts(
  await Astro.glob("../pages/craft/*.mdx")
);

const currPostIdx = posts.findIndex(
  (post) => post.frontmatter.title === frontmatter.title
);
const prevProject = posts[currPostIdx - 1];
const nextProject = posts[currPostIdx + 1];

const prevTitle = prevProject?.frontmatter?.title;
const nextTitle = nextProject?.frontmatter?.title;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="description"
      content="Kristjan Poska is a talented product designer with an ability to think of tomorrow's solutions today."
    />
    <meta name="viewport" content="width=device-width" />

    <meta name="theme-color" content="#F27059" />

    <meta
      property="og:title"
      content="Kristjan Poska – Product Designer"
    />

    <meta
      property="og:description"
      content="Kristjan Poska is a talented product designer with an ability to think of tomorrow's solutions today."
    />

    <meta
      property="og:image"
      content="/images/og-image.png"
    />

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/apple-touch-icon.png"
    />

    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicon-32x32.png"
    />

    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicon-16x16.png"
    />

    <link rel="manifest" href="/site.webmanifest" />

    <meta name="generator" content={Astro.generator} />

    <title>{frontmatter.title}</title>
  </head>

  <body class="mx-8 my-8">
    <main class="mx-auto max-w-xl">
      <div class="relative my-8">
        <a
          class="hover:text-theme-orange mb-8 flex items-center gap-2 text-sm leading-6 text-neutral-500 transition-colors lg:absolute lg:-left-32"
          href="/">
          <CornerUpLeft class="h-3 w-3" />
           Back
        </a>

        <h1 class="font-semibold">
          {frontmatter.title}
        </h1>

        <div class="mb-4 text-neutral-500">
          {frontmatter.description}
        </div>

        <img
          class="aspect-video max-w-full bg-center object-cover transition"
          src={frontmatter.cover}
          alt={frontmatter.cover_alt}
        />
      </div>

      <div class="project">
        <slot />
      </div>

      <hr class="my-8" />

      <section
        class:list={[
          "flex items-center gap-8",
          { "justify-end": !prevProject && nextProject },
          { "justify-between": prevProject && nextProject },
        ]}>
        {
          prevProject && (
            <a
              class="hover:text-theme-orange transition-colors"
              href={prevProject?.url}>
              ← Previous project ({prevTitle})
            </a>
          )
        }
        {
          nextProject && (
            <a
              class="hover:text-theme-orange transition-colors"
              href={nextProject?.url}>
              Next project ({nextTitle}) →
            </a>
          )
        }
      </section>
    </main>
  </body>
</html>
